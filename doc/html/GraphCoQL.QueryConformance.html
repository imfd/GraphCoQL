
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">GraphCoQL.QueryConformance</h1>

<div class="code">

<br/>
</div>

<div class="doc">
   <div class="jumbotron">
      <div class="container">
        <h1 class="display-4">Query Conformance</h1>
        <p class="lead">
         This file contains the necessary definitions to validate when a GraphQL Query
         is valid wrt. to a Schema. 
        </p>
         <p>
         This notion includes things such as: 
          <ul>
           <li> Field selection over a type is actually defined in that type. </li>
           <li> Arguments have valid names </li>
           <li> Inline fragments are applied on valid types </li>
           <li> Etc. </li>
         </ul>
        </p>
         <p>
         We will progressively define predicates that check different aspects of a query;
         check if an argument conforms, do fields merge, etc. 
         From these we will ultimately define the predicate for conformed queries.
        </p>
  </div>
</div>
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a name="QueryConformance"><span class="id" title="section">QueryConformance</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variables</span> (<a name="QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a> : <span class="id" title="abbreviation">eqType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a name="QueryConformance.check_scalar"><span class="id" title="variable">check_scalar</span></a> : <a class="idref" href="GraphCoQL.Schema.html#graphQLSchema"><span class="id" title="record">graphQLSchema</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#Scalar"><span class="id" title="variable">Scalar</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>).<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (@<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> σ : @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="QueryConformance.s"><span class="id" title="variable">s</span></a> : <a class="idref" href="GraphCoQL.SchemaWellFormedness.html#wfGraphQLSchema"><span class="id" title="record">wfGraphQLSchema</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab48"></a><h1 class="section">Conformance Predicates</h1>
<hr/>
 
<div class="paragraph"> </div>

<a name="lab49"></a><h2 class="section">Are selections consistent ?</h2>

<hr/>


<div class="paragraph"> </div>

      First we define the necessary predicates to establish that a query is consistent 
      by itself.
   
<div class="paragraph"> </div>

<a name="lab50"></a><h3 class="section">Arguments conform</h3>

<hr/>


<div class="paragraph"> </div>

      The following predicate checks whether a list of arguments (described as a pairing between names and values)
      conform to a list of field arguments.

<div class="paragraph"> </div>

      This is used when checking whether a field selection is consistent with a type in the schema.

<div class="paragraph"> </div>

      For a query argument to be valid it must satisfy the following:
<ul class="doclist">
<li> There exists an argument definition with the same name (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#sec-Argument-Names'><span>&#167;</span>5.4.1</a>).

</li>
<li> The value given to the query argument must be valid w.r.t. its expected type (<a href='https://graphql.github.io/graphql-spec/June2018/#sec-Values-of-Correct-Type'><span>&#167;</span>5.6.1</a>).      

</li>
</ul>

<div class="paragraph"> </div>

   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="arguments_conform"><span class="id" title="definition">arguments_conform</span></a> <a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#found_pairs_with_response_name_leq"><span class="id" title="lemma">(</span></a><a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#found_pairs_with_response_name_leq"><span class="id" title="lemma">args</span></a> <a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#found_pairs_with_response_name_leq"><span class="id" title="lemma">:</span></a> <span class="id" title="abbreviation">seq</span> <a class="idref" href="GraphCoQL.Schema.html#FieldArgumentDefinition"><span class="id" title="record">FieldArgumentDefinition</span></a>) (<span class="id" title="var">α</span> : <span class="id" title="abbreviation">seq</span> (<a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> @<a class="idref" href="GraphCoQL.Value.html#Value"><span class="id" title="inductive">Value</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a><a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#merge_pair_selections_leq"><span class="id" title="lemma">))</span></a> <a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#merge_pair_selections_leq"><span class="id" title="lemma">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#merge_pair_selections_leq"><span class="id" title="lemma">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">argument_conforms</span></a> <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">(</span></a><a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">arg</span></a> <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">:</span></a> <a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> @<a class="idref" href="GraphCoQL.Value.html#Value"><span class="id" title="inductive">Value</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">name</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">value</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="GraphCoQL.QueryConformance.html#arg"><span class="id" title="variable">arg</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">has</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">argdef</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#argdef"><span class="id" title="variable">argdef</span></a>.(<a class="idref" href="GraphCoQL.Schema.html#argname"><span class="id" title="projection">argname</span></a>) <span class="id" title="notation">==</span> <span class="id" title="var">name</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.SchemaAux.html#is_valid_value"><span class="id" title="definition">is_valid_value</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.check_scalar"><span class="id" title="variable">check_scalar</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#argdef"><span class="id" title="variable">argdef</span></a>.(<a class="idref" href="GraphCoQL.Schema.html#argtype"><span class="id" title="projection">argtype</span></a>) <span class="id" title="var">value</span>) <a class="idref" href="GraphCoQL.QueryConformance.html#args"><span class="id" title="variable">args</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> <a class="idref" href="GraphCoQL.QueryConformance.html#argument_conforms"><span class="id" title="variable">argument_conforms</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="definition">uniq</span> <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#arg"><span class="id" title="variable">arg</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#e0817251e7d67ad994b4d9b1aa82a412"><span class="id" title="notation">.1</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">arg</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.QueryConformance.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><span class="id" title="notation">]</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 <a name="lab51"></a><h3 class="section">Is selection consistent ?</h3>


<div class="paragraph"> </div>

      Checks whether a query is consistent to a given type in the schema.

<div class="paragraph"> </div>

      This checks the following:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Fields are defined in the type in scope (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#sec-Field-Selections-on-Objects-Interfaces-and-Unions-Types'><span>&#167;</span>5.3.1</a>)

<div class="paragraph"> </div>


</li>
<li> Field selection's arguments should conform to the arguments declared in the field definition obtained previously.

<div class="paragraph"> </div>


</li>
<li> Leaf field selections should have Scalar or Enum return type (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#sec-Leaf-Field-Selections'><span>&#167;</span>5.3.3</a>).

<div class="paragraph"> </div>


</li>
<li> Node field selections should have Object, Interface or Union return type (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#sec-Leaf-Field-Selections'><span>&#167;</span>5.3.3</a>).

<div class="paragraph"> </div>


</li>
<li> Nested subqueries should not be empty (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#sec-Leaf-Field-Selections'><span>&#167;</span>5.3.3</a>).

<div class="paragraph"> </div>


</li>
<li> Nested subqueries should be consistent wrt. to its parent type (return type for fields or type condition for fragments).

<div class="paragraph"> </div>


</li>
<li> Fragments' type condition must spread in the type in context (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#sec-Fragment-spread-is-possible'><span>&#167;</span>5.5.2.3</a>).

</li>
</ul>

<div class="paragraph"> </div>

   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="is_consistent"><span class="id" title="definition">is_consistent</span></a> (<span class="id" title="var">ts</span> : <a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a>) σ : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.SchemaAux.html#is_scalar_type"><span class="id" title="definition">is_scalar_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="GraphCoQL.SchemaAux.html#is_enum_type"><span class="id" title="definition">is_enum_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#arguments_conform"><span class="id" title="definition">arguments_conform</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#fargs"><span class="id" title="projection">fargs</span></a>) <span class="id" title="var">α</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.SchemaAux.html#is_scalar_type"><span class="id" title="definition">is_scalar_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="GraphCoQL.SchemaAux.html#is_enum_type"><span class="id" title="definition">is_enum_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#arguments_conform"><span class="id" title="definition">arguments_conform</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#fargs"><span class="id" title="projection">fargs</span></a>) <span class="id" title="var">α</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> { σ<span class="id" title="var">s</span> } =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="GraphCoQL.SchemaAux.html#is_abstract_type"><span class="id" title="definition">is_abstract_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#arguments_conform"><span class="id" title="definition">arguments_conform</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#fargs"><span class="id" title="projection">fargs</span></a>) <span class="id" title="var">α</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id" title="var">s</span> <span class="id" title="notation">!=</span> <span class="id" title="notation">[::]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#is_consistent"><span class="id" title="definition">is_consistent</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)) σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> { σ<span class="id" title="var">s</span> } =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="GraphCoQL.SchemaAux.html#is_abstract_type"><span class="id" title="definition">is_abstract_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#arguments_conform"><span class="id" title="definition">arguments_conform</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#fargs"><span class="id" title="projection">fargs</span></a>) <span class="id" title="var">α</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id" title="var">s</span> <span class="id" title="notation">!=</span> <span class="id" title="notation">[::]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#is_consistent"><span class="id" title="definition">is_consistent</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)) σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <span class="id" title="var">t</span> { σ<span class="id" title="var">s</span> } =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryAux.html#is_fragment_spread_possible"><span class="id" title="definition">is_fragment_spread_possible</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a> <span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;σ<span class="id" title="var">s</span> <span class="id" title="notation">!=</span> <span class="id" title="notation">[::]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#is_consistent"><span class="id" title="definition">is_consistent</span></a> <span class="id" title="var">t</span>) σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab52"></a><h2 class="section">Are selections type-compatible ?</h2>

<hr/>


<div class="paragraph"> </div>

      In this segment we define the necessary predicates to establish if selections 
      are type-compatible.

<div class="paragraph"> </div>

      Intuitively, this validation forbids selections with the same response name producing 
      results associated to values of different types 
      (e.g. a key associated to string values in one case and integer in others).
   
<div class="paragraph"> </div>

<hr/>
 
<div class="paragraph"> </div>

    Checks whether two types are compatible. 

<div class="paragraph"> </div>

    This corresponds to steps 3-6 used in the spec's definition for <i>SameResponseShape</i> 
    (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#SameResponseShape()'><span>&#167;</span>5.3.2</a>).
    spec.  
  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="are_compatible_types"><span class="id" title="definition">are_compatible_types</span></a> (<span class="id" title="var">ty</span> <span class="id" title="var">ty'</span> : <a class="idref" href="GraphCoQL.Schema.html#type"><span class="id" title="inductive">type</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="GraphCoQL.QueryConformance.html#ty"><span class="id" title="variable">ty</span></a>, <a class="idref" href="GraphCoQL.QueryConformance.html#ty'"><span class="id" title="variable">ty'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="GraphCoQL.Schema.html#NamedType"><span class="id" title="constructor">NamedType</span></a> <span class="id" title="var">rty</span>, <a class="idref" href="GraphCoQL.Schema.html#NamedType"><span class="id" title="constructor">NamedType</span></a> <span class="id" title="var">rty'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.SchemaAux.html#is_scalar_type"><span class="id" title="definition">is_scalar_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">rty</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="GraphCoQL.SchemaAux.html#is_enum_type"><span class="id" title="definition">is_enum_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">rty</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rty</span> <span class="id" title="notation">==</span> <span class="id" title="var">rty'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.SchemaAux.html#is_composite_type"><span class="id" title="definition">is_composite_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">rty'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="GraphCoQL.Schema.html#ListType"><span class="id" title="constructor">ListType</span></a> <span class="id" title="var">rty</span>, <a class="idref" href="GraphCoQL.Schema.html#ListType"><span class="id" title="constructor">ListType</span></a> <span class="id" title="var">rty'</span> =&gt; <a class="idref" href="GraphCoQL.QueryConformance.html#are_compatible_types"><span class="id" title="definition">are_compatible_types</span></a> <span class="id" title="var">rty</span> <span class="id" title="var">rty'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

    Checks whether a given selection has a return type compatible to the 
    one given as parameter. 

<div class="paragraph"> </div>

    The first parameter corresponds to the type of another field to which we 
    wish to know if they are type compatible.

<div class="paragraph"> </div>

    The pair correspond to the selection along with the type where it was defined. 

<div class="paragraph"> </div>

    Inline fragments do not have a return type, therefore this always 
    returns false for these cases.
  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="has_compatible_type"><span class="id" title="definition">has_compatible_type</span></a> (<span class="id" title="var">rty</span> : <a class="idref" href="GraphCoQL.Schema.html#type"><span class="id" title="inductive">type</span></a>) (<span class="id" title="var">nq</span> : <a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="GraphCoQL.QueryConformance.html#nq"><span class="id" title="variable">nq</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ty</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a> <span class="id" title="var">_</span> <a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_compatible_types"><span class="id" title="definition">are_compatible_types</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="GraphCoQL.QueryConformance.html#rty"><span class="id" title="variable">rty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ty</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a> <span class="id" title="var">_</span> <a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_compatible_types"><span class="id" title="definition">are_compatible_types</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="GraphCoQL.QueryConformance.html#rty"><span class="id" title="variable">rty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ty</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a> <span class="id" title="var">_</span> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> { <span class="id" title="var">_</span> }<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_compatible_types"><span class="id" title="definition">are_compatible_types</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="GraphCoQL.QueryConformance.html#rty"><span class="id" title="variable">rty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">ty</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a> <span class="id" title="var">_</span> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> { <span class="id" title="var">_</span> }<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">fld</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_compatible_types"><span class="id" title="definition">are_compatible_types</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) <a class="idref" href="GraphCoQL.QueryConformance.html#rty"><span class="id" title="variable">rty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <span class="id" title="var">_</span> { <span class="id" title="var">_</span> }<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab53"></a><h3 class="section">Type-Compatible</h3>

<hr/>


<div class="paragraph"> </div>

    Checks whether a list of selections have compatible return types.

<div class="paragraph"> </div>

    Two nested field selections are type-compatible if whenever
    they have the same response name, any two fields in the concatenation of their
    subselections are also type-compatible. Two single field selections
    are always type-compatible, unless they have the same response
    name and different (scalar or enum) type.
    Fragments are simply lifted, taking care to wrap each subselection with the type condition.

<div class="paragraph"> </div>

    We have to wrap each query with its parent type in order to find their appropriate return type.

<div class="paragraph"> </div>

    This definition roughly translate to the <i>SameResponseShape</i> function defined in the Spec 
    (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#SameResponseShape()'><span>&#167;</span>5.3.2</a>). 
    However, we noticed that there are redundant recursive calls between this function and the function <i>FieldsInSetCanMerge</i>
    (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#FieldsInSetCanMerge()'><span>&#167;</span>5.3.2</a>), 
    which meant definition was hard in Coq plus possibly costly (due to repeated recursive calls).

<div class="paragraph"> </div>

    We also notice that this definition is a little bit conservative, in the sense that it
    may consider valid queries invalid (See <a href='https://tinyurl.com/y4uxz3gu'>example</a>),
    due to an issue with inline fragments possibly allowing selections over any type
    (See <a href='https://github.com/graphql/graphql-spec/issues/367'>issue</a>).
  
</div>
<div class="code">
&nbsp;<span class="id" title="keyword">Equations</span>? <a name="are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (<a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a>)) :<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <span class="id" title="tactic">by</span> <span class="id" title="keyword">wf</span> (<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>) :=<br/>
&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> <span class="id" title="notation">[::]</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> ;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#cons"><span class="id" title="constructor">_</span></a> <a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#fld"><span class="id" title="variable">fld</span></a> := <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#has_compatible_type"><span class="id" title="definition">has_compatible_type</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)) (<a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="comment">(*&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;not&nbsp;defined&nbsp;in&nbsp;its&nbsp;own&nbsp;type&nbsp;in&nbsp;scope&nbsp;it&nbsp;should&nbsp;fail&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#cons"><span class="id" title="constructor">_</span></a> <a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#fld"><span class="id" title="variable">fld</span></a> := <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#has_compatible_type"><span class="id" title="definition">has_compatible_type</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)) (<a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="comment">(*&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;not&nbsp;defined&nbsp;in&nbsp;its&nbsp;own&nbsp;type&nbsp;in&nbsp;scope&nbsp;it&nbsp;should&nbsp;fail&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#cons"><span class="id" title="constructor">_</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3733fe9c7e1c58f64d5198dad8aad412"><span class="id" title="variable">βs</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#fld"><span class="id" title="variable">fld</span></a> := <span class="id" title="keyword">let</span> <span class="id" title="var">similar_queries</span> := <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#has_compatible_type"><span class="id" title="definition">has_compatible_type</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)) <a class="idref" href="GraphCoQL.QueryConformance.html#similar_queries"><span class="id" title="variable">similar_queries</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>).(<a class="idref" href="GraphCoQL.Schema.html#tname"><span class="id" title="definition">tname</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">q</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_pairs_selection_sets"><span class="id" title="definition">merge_pairs_selection_sets</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#similar_queries"><span class="id" title="variable">similar_queries</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="comment">(*&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;not&nbsp;defined&nbsp;in&nbsp;its&nbsp;own&nbsp;type&nbsp;in&nbsp;scope&nbsp;it&nbsp;should&nbsp;fail&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#cons"><span class="id" title="constructor">_</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3733fe9c7e1c58f64d5198dad8aad412"><span class="id" title="variable">βs</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#fld"><span class="id" title="variable">fld</span></a> := <span class="id" title="keyword">let</span> <span class="id" title="var">similar_queries</span> := <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#has_compatible_type"><span class="id" title="definition">has_compatible_type</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)) <a class="idref" href="GraphCoQL.QueryConformance.html#similar_queries"><span class="id" title="variable">similar_queries</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>).(<a class="idref" href="GraphCoQL.Schema.html#tname"><span class="id" title="definition">tname</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">q</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_pairs_selection_sets"><span class="id" title="definition">merge_pairs_selection_sets</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#similar_queries"><span class="id" title="variable">similar_queries</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="comment">(*&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;not&nbsp;defined&nbsp;in&nbsp;its&nbsp;own&nbsp;type&nbsp;in&nbsp;scope&nbsp;it&nbsp;should&nbsp;fail&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3733fe9c7e1c58f64d5198dad8aad412"><span class="id" title="variable">βs</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>) := <a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">q</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> ? [<span class="id" title="tactic">rewrite</span> ?/<span class="id" title="var">similar_queries</span>; <span class="id" title="var">leq_selections_size</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: {2}(<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">_</span>) (<span class="id" title="lemma">leqnn</span> (<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>)) =&gt; <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span>: <span class="id" title="var">n</span> <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span> =&gt; /= [| <span class="id" title="var">n</span> <span class="id" title="var">IH</span>] <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leqn0</span> =&gt; /<a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#selections_size_aux_0_nil"><span class="id" title="lemma">selections_size_aux_0_nil</span></a> -&gt;; <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span> =&gt; /= [| <span class="id" title="var">scoped_</span>σ <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>]; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">scoped_</span>σ =&gt; <span class="id" title="var">ts</span> σ.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_selection</span> σ; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> /= -/(<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">simp</span> <span class="id" title="var">selection_size</span> =&gt; <span class="id" title="var">Hleq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simp</span> <span class="id" title="var">are_type_compatible</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">do</span> ? [<span class="id" title="var">lookup</span>; <span class="id" title="tactic">constructor</span>]; <span class="id" title="tactic">apply</span>: <span class="id" title="var">IH</span>; <span class="id" title="var">leq_selections_size</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab54"></a><h2 class="section">Are selections renaming-consistent ?</h2>

<hr/>


<div class="paragraph"> </div>

     Checks whether a list of selections are renaming-consistent.

<div class="paragraph"> </div>

     Two field selections are <i>renaming-consistent</i> if whenever they have the
     same response name and lie under overlapping types in context
     they have the same (actual) name, the same arguments and any two
     fields in the concatenation of their subselections are also
     renaming-consistent.

<div class="paragraph"> </div>

     This definition roughly corresponds to 
     (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#FieldsInSetCanMerge()'><span>&#167;</span>5.3.2</a>).
     The differences are due to the same reasons given in <span class="inlinecode"><a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a></span>.
  
</div>
<div class="code">
&nbsp;<span class="id" title="keyword">Equations</span>? <a name="are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (<a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.Scalar"><span class="id" title="variable">Scalar</span></a>)) :<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <span class="id" title="tactic">by</span> <span class="id" title="keyword">wf</span> (<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>) :=<br/>
&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> <span class="id" title="notation">[::]</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="notation">(</span><a class="idref" href="GraphCoQL.QueryAux.html#find_valid_pairs_with_response_name"><span class="id" title="definition">find_valid_pairs_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span><span class="id" title="notation">)]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="notation">(</span><a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span><span class="id" title="notation">)]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="notation">(</span><a class="idref" href="GraphCoQL.QueryAux.html#find_valid_pairs_with_response_name"><span class="id" title="definition">find_valid_pairs_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span><span class="id" title="notation">)]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <span class="id" title="notation">(</span><a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span><span class="id" title="notation">)]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3733fe9c7e1c58f64d5198dad8aad412"><span class="id" title="variable">βs</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#fld"><span class="id" title="variable">fld</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <span class="id" title="keyword">let</span> <span class="id" title="var">similar_</span>σ<span class="id" title="var">s</span> := <a class="idref" href="GraphCoQL.QueryAux.html#find_valid_pairs_with_response_name"><span class="id" title="definition">find_valid_pairs_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <span class="id" title="var">βs</span> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a><span class="id" title="notation">]</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>).(<a class="idref" href="GraphCoQL.Schema.html#tname"><span class="id" title="definition">tname</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> σ <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_pairs_selection_sets"><span class="id" title="definition">merge_pairs_selection_sets</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <span class="id" title="keyword">let</span> <span class="id" title="var">similar_</span>σ<span class="id" title="var">s</span> := <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <span class="id" title="var">βs</span> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a><span class="id" title="notation">]</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>).(<a class="idref" href="GraphCoQL.Schema.html#tname"><span class="id" title="definition">tname</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> σ <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_pairs_selection_sets"><span class="id" title="definition">merge_pairs_selection_sets</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3733fe9c7e1c58f64d5198dad8aad412"><span class="id" title="variable">βs</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#fld"><span class="id" title="variable">fld</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <span class="id" title="keyword">let</span> <span class="id" title="var">similar_</span>σ<span class="id" title="var">s</span> := <a class="idref" href="GraphCoQL.QueryAux.html#find_valid_pairs_with_response_name"><span class="id" title="definition">find_valid_pairs_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <span class="id" title="var">βs</span> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a><span class="id" title="notation">]</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>).(<a class="idref" href="GraphCoQL.Schema.html#tname"><span class="id" title="definition">tname</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> σ <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_pairs_selection_sets"><span class="id" title="definition">merge_pairs_selection_sets</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <span class="id" title="keyword">let</span> <span class="id" title="var">similar_</span>σ<span class="id" title="var">s</span> := <a class="idref" href="GraphCoQL.QueryAux.html#find_pairs_with_response_name"><span class="id" title="definition">find_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryAux.html#are_equivalent"><span class="id" title="definition">are_equivalent</span></a> (<span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <span class="id" title="var">βs</span> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a>)) <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.QueryConformance.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">.2</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">p</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a><span class="id" title="notation">]</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>).(<a class="idref" href="GraphCoQL.Schema.html#tname"><span class="id" title="definition">tname</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> σ <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_pairs_selection_sets"><span class="id" title="definition">merge_pairs_selection_sets</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">similar_</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#46ff8759a92b2b737454b91c70ca01b6"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_pairs_with_response_name"><span class="id" title="definition">filter_pairs_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3733fe9c7e1c58f64d5198dad8aad412"><span class="id" title="variable">βs</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.QueryAux.html#is_fragment_spread_possible"><span class="id" title="definition">is_fragment_spread_possible</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ts</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> σ <span class="id" title="notation">&lt;-</span> <span class="id" title="var">βs</span><span class="id" title="notation">]</span> <span class="id" title="notation">++</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> ? [<span class="id" title="tactic">rewrite</span> ?/<span class="id" title="var">similar_</span>σ<span class="id" title="var">s</span>; <span class="id" title="var">leq_selections_size</span>].<br/>
&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: {2}(<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">_</span>) (<span class="id" title="lemma">leqnn</span> (<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>)) =&gt; <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span>: <span class="id" title="var">n</span> <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span> =&gt; /= [| <span class="id" title="var">n</span> <span class="id" title="var">IH</span>] <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leqn0</span> =&gt; /<a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#selections_size_aux_0_nil"><span class="id" title="lemma">selections_size_aux_0_nil</span></a> -&gt;; <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span> =&gt; /= [| <span class="id" title="var">scoped_</span>σ <span class="id" title="var">scoped_</span>σ<span class="id" title="var">s</span>]; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">scoped_</span>σ =&gt; <span class="id" title="var">ts</span> σ.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_selection</span> σ; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> /= -/(<a class="idref" href="GraphCoQL.QueryAux.html#selections_size_aux"><span class="id" title="definition">selections_size_aux</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">simp</span> <span class="id" title="var">selection_size</span> =&gt; <span class="id" title="var">Hle</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">simp</span> <span class="id" title="var">are_renaming_consistent</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">do</span> ? [<span class="id" title="var">lookup</span>; <span class="id" title="tactic">constructor</span>]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span> <a class="idref" href="GraphCoQL.QueryAux.html#is_fragment_spread_possible"><span class="id" title="definition">is_fragment_spread_possible</span></a>; <span class="id" title="tactic">constructor</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="var">IH</span>; <span class="id" title="var">leq_selections_size</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> ? [<span class="id" title="tactic">case</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a>; <span class="id" title="tactic">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> ? [<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="var">IH</span>; <span class="id" title="var">leq_selections_size</span>].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab55"></a><h2 class="section">Selection Conformance</h2>

<hr/>


<div class="paragraph"> </div>

     Check whether a list of selections conform to a given type in the schema.

<div class="paragraph"> </div>

     This definition captures the previous validation predicates:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Evey selection is consistent,

<div class="paragraph"> </div>


</li>
<li> selections are type-compatible, and

<div class="paragraph"> </div>


</li>
<li> are renaming-consistent.

</li>
</ul>

<div class="paragraph"> </div>

   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="selections_conform"><span class="id" title="definition">selections_conform</span></a> (<span class="id" title="var">ts</span> : <a class="idref" href="GraphCoQL.Query.html#Name"><span class="id" title="abbreviation">Name</span></a>) σ<span class="id" title="var">s</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> σ<span class="id" title="var">s_with_scope</span> := <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">|</span> σ <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a><span class="id" title="notation">]</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<a class="idref" href="GraphCoQL.QueryConformance.html#is_consistent"><span class="id" title="definition">is_consistent</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#ts"><span class="id" title="variable">ts</span></a>) <a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#615e1ae49111e0c86ab93c271406794b"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#615e1ae49111e0c86ab93c271406794b"><span class="id" title="variable">s_with_scope</span></a>.(<a class="idref" href="GraphCoQL.QueryConformance.html#are_type_compatible"><span class="id" title="definition">are_type_compatible</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#615e1ae49111e0c86ab93c271406794b"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryConformance.html#615e1ae49111e0c86ab93c271406794b"><span class="id" title="variable">s_with_scope</span></a>.(<a class="idref" href="GraphCoQL.QueryConformance.html#are_renaming_consistent"><span class="id" title="definition">are_renaming_consistent</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 <a name="lab56"></a><h1 class="section">Query conformance</h1>


<div class="paragraph"> </div>

      A query conforms if its selection set conforms to the Query type.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="query_conforms"><span class="id" title="definition">query_conforms</span></a> (φ : <a class="idref" href="GraphCoQL.Query.html#query"><span class="id" title="record">query</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryConformance.html#selections_conform"><span class="id" title="definition">selections_conform</span></a> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance.s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.Schema.html#query_type"><span class="id" title="projection">query_type</span></a>) <a class="idref" href="GraphCoQL.QueryConformance.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a>.(<a class="idref" href="GraphCoQL.Query.html#selection_set"><span class="id" title="projection">selection_set</span></a>).<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="GraphCoQL.QueryConformance.html#QueryConformance"><span class="id" title="section">QueryConformance</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

    <div>
        <a href='GraphCoQL.Query.html' class="btn btn-light" role='button'> Previous ← Query  </a>
        <a href='GraphCoQL.QueryNormalForm.html' class="btn btn-info" role='button'>Continue Reading → Normal Form </a>
    </div>

</div>
<div class="code">
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
  </script>

</body>

</html>
