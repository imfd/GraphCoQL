
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">GraphCoQL.QueryNormalForm</h1>

<div class="code">

<br/>
</div>

<div class="doc">
   <div class="jumbotron">
      <div class="container">
        <h1 class="display-4">Normal Form</h1>
        <p class="lead">
         This file contains the basic predicates for groundedness and non-redundancy of queries,
         and also contains the normalization procedure.
        </p>
         
  </div>
</div>
 
<div class="paragraph"> </div>

<a name="lab61"></a><h1 class="section">Definitions</h1>
<hr/>
 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a name="NormalForm"><span class="id" title="section">NormalForm</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variables</span> <a name="NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a> : <span class="id" title="abbreviation">eqType</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variables</span> (<a name="NormalForm.s"><span class="id" title="variable">s</span></a> : <a class="idref" href="GraphCoQL.SchemaWellFormedness.html#wfGraphQLSchema"><span class="id" title="record">wfGraphQLSchema</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (@<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> σ : @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab62"></a><h2 class="section">Groundedness</h2>

<hr/>


<div class="paragraph"> </div>

      In this section we define the predicates to establish when a 
      GraphQL Selection is in ground-typed normal form (grounded for short).
   
<div class="paragraph"> </div>

     Checks whether the given selection is in ground-typed normal form, as defined in H&amp;P.

<div class="paragraph"> </div>

     A selection set σ̅ is in ground-typed normal form if it satisfies the following grammar, 
     where t is an object type.

<div class="paragraph"> </div>

     <img src='../imgs/GTNF/gtnf.png' class='img-fluid' alt='Ground-typed normal form grammar'>     
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="is_in_ground_typed_nf"><span class="id" title="definition">is_in_ground_typed_nf</span></a> (σ : @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#3122c41ebe889f745cb9bbe1c92165c3"><span class="id" title="variable">σ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> { σ<span class="id" title="var">s</span> } =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><span class="id" title="definition">all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryAux.html#is_field"><span class="id" title="definition">is_field</span></a>)) σ<span class="id" title="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <span class="id" title="definition">all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryAux.html#is_inline_fragment"><span class="id" title="definition">is_inline_fragment</span></a>)) σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="definition">all</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#is_in_ground_typed_nf"><span class="id" title="definition">is_in_ground_typed_nf</span></a> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><span class="id" title="var">_</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> { σ<span class="id" title="var">s</span> } =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><span class="id" title="definition">all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryAux.html#is_field"><span class="id" title="definition">is_field</span></a>)) σ<span class="id" title="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <span class="id" title="definition">all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryAux.html#is_inline_fragment"><span class="id" title="definition">is_inline_fragment</span></a>)) σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="definition">all</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#is_in_ground_typed_nf"><span class="id" title="definition">is_in_ground_typed_nf</span></a> σ<span class="id" title="var">s</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <span class="id" title="var">t</span> { σ<span class="id" title="var">s</span> } =&gt; <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="definition">all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryAux.html#is_field"><span class="id" title="definition">is_field</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryNormalForm.html#is_in_ground_typed_nf"><span class="id" title="definition">is_in_ground_typed_nf</span></a>)) σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

     Checks whether the given selection set is in ground-typed normal form, as defined in H&amp;P.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="are_in_ground_typed_nf"><span class="id" title="definition">are_in_ground_typed_nf</span></a> (σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (@<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><span class="id" title="definition">all</span> (@<a class="idref" href="GraphCoQL.QueryAux.html#is_field"><span class="id" title="definition">is_field</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>) <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <span class="id" title="definition">all</span> (@<a class="idref" href="GraphCoQL.QueryAux.html#is_inline_fragment"><span class="id" title="definition">is_inline_fragment</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>) <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="definition">all</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#is_in_ground_typed_nf"><span class="id" title="definition">is_in_ground_typed_nf</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

     Checks whether the given query is in ground-typed normal form, by checking that its selection set is
     in ground-typed normal form.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="is_a_ground_typed_nf_query"><span class="id" title="definition">is_a_ground_typed_nf_query</span></a> (φ : @<a class="idref" href="GraphCoQL.Query.html#query"><span class="id" title="record">query</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a>.(<a class="idref" href="GraphCoQL.Query.html#selection_set"><span class="id" title="projection">selection_set</span></a>).(<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_in_ground_typed_nf"><span class="id" title="definition">are_in_ground_typed_nf</span></a>).<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab63"></a><h2 class="section">Non-redundancy</h2>

<hr/>


<div class="paragraph"> </div>

      In this section we define the predicate to establish when a GraphQL Selection 
      is non-redundant.
   
<div class="paragraph"> </div>

     Checks whether a selection set is non-redundant.
     This checks that :
<ul class="doclist">
<li> There are no inline fragments with the same type condition.

</li>
<li> There are no field selections with the same response name.

</li>
</ul>
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span>? <a name="are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> (σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (@<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="keyword">wf</span> (<a class="idref" href="GraphCoQL.QueryAux.html#selections_size"><span class="id" title="definition">selections_size</span></a> σ<span class="id" title="var">s</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> <span class="id" title="notation">[::]</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> (<a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#dc5233cb1d950ecad15b1e9b2514f665"><span class="id" title="variable">β</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">}</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryAux.html#find_fragment_with_type_condition"><span class="id" title="definition">find_fragment_with_type_condition</span></a> <span class="id" title="var">t</span> σ<span class="id" title="var">s</span> <span class="id" title="notation">==</span> <span class="id" title="notation">[::]</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> <span class="id" title="var">β</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> (<a class="idref" href="GraphCoQL.QueryNormalForm.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">[&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryAux.html#find_fields_with_response_name"><span class="id" title="definition">find_fields_with_response_name</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#qresponse_name"><span class="id" title="definition">qresponse_name</span></a> <span class="id" title="var">q</span> <span class="id" title="var">_</span>) σ<span class="id" title="var">s</span> <span class="id" title="notation">==</span> <span class="id" title="notation">[::]</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> <a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#filter_fields_with_response_name_leq_size"><span class="id" title="lemma">q</span></a><a class="idref" href="GraphCoQL.theory.QueryAuxLemmas.html#filter_fields_with_response_name_leq_size"><span class="id" title="lemma">.(</span></a><a class="idref" href="GraphCoQL.QueryAux.html#subselections"><span class="id" title="definition">subselections</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a> σ<span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5a7d806905be2a0d04047156433535f1"><span class="id" title="notation">]</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> ? [<span class="id" title="tactic">case</span>: <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> ? <span class="id" title="tactic">intros</span>; <span class="id" title="var">simp</span> <span class="id" title="var">selection_size</span>; <span class="id" title="var">ssromega</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

     Checks whether a query is non-redundant by checking that its selection set is 
     non-redundant.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="is_non_redundant"><span class="id" title="definition">is_non_redundant</span></a> (φ : @<a class="idref" href="GraphCoQL.Query.html#query"><span class="id" title="record">query</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> := <a class="idref" href="GraphCoQL.QueryNormalForm.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a>.(<a class="idref" href="GraphCoQL.Query.html#selection_set"><span class="id" title="projection">selection_set</span></a>).(<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a>).<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab64"></a><h2 class="section">Normal form</h2>
<hr/>
 
<div class="paragraph"> </div>


<div class="paragraph"> </div>

     Checks whether a selection set is in normal form.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="are_in_normal_form"><span class="id" title="definition">are_in_normal_form</span></a> (σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_in_ground_typed_nf"><span class="id" title="definition">are_in_ground_typed_nf</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_non_redundant"><span class="id" title="definition">are_non_redundant</span></a>).<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

     Checks whether a query is in normal form.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="is_in_normal_form"><span class="id" title="definition">is_in_normal_form</span></a> (φ : @<a class="idref" href="GraphCoQL.Query.html#query"><span class="id" title="record">query</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm.Scalar"><span class="id" title="variable">Scalar</span></a>) := <a class="idref" href="GraphCoQL.QueryNormalForm.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a>.(<a class="idref" href="GraphCoQL.Query.html#selection_set"><span class="id" title="projection">selection_set</span></a>).(<a class="idref" href="GraphCoQL.QueryNormalForm.html#are_in_normal_form"><span class="id" title="definition">are_in_normal_form</span></a>).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#NormalForm"><span class="id" title="section">NormalForm</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab65"></a><h1 class="section">Normalization</h1>

<hr/>


<div class="paragraph"> </div>

      In this section we will define a normalization procedure, which 
      takes a GraphQL Selection and outputs another one in normal form.

<div class="paragraph"> </div>

   
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a name="Normalization"><span class="id" title="section">Normalization</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variables</span> <a name="Normalization.Scalar"><span class="id" title="variable">Scalar</span></a> : <span class="id" title="abbreviation">eqType</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> σ : @<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.Scalar"><span class="id" title="variable">Scalar</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Normalization.s"><span class="id" title="variable">s</span></a> : <a class="idref" href="GraphCoQL.SchemaWellFormedness.html#wfGraphQLSchema"><span class="id" title="record">wfGraphQLSchema</span></a>.<br/>

<br/>
</div>

<div class="doc">
     Normalizes the given list of selections. 
     The resulting list are non-redundant and in ground-type 
     normal form.

<div class="paragraph"> </div>

     Normalization consists of two main processes :

<div class="paragraph"> </div>

<ul class="doclist">
<li> Eliminating redundancies via merging : Fields which share 
        a response name are collapsed/collected into the first occurrence of 
        this set of common fields. This resembles the process carried out 
        by the semantics in <i>CollectFields</i> (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#CollectFields()'><span>&#167;</span>6.3.2</a>)
        and <i>MergeSelectionSets</i> (cf. <a href='https://graphql.github.io/graphql-spec/June2018/#MergeSelectionSets()'><span>&#167;</span>6.4.3</a>).

<div class="paragraph"> </div>


</li>
<li> Grounding : Queries which are supposed to occur in abstract types 
        (be it an inline fragment with an abstract type condition or a    
        field with an abstract return type) are specialized into every
        possible concrete object subtype.
        This means that fragments might be "lifted" (its type condition is removed and its 
        subselections lifted) or removed if they do not make sense in the context
        On the other hand, fields' subselections might be wrapped in fragments, specializing their contents.

</li>
</ul>
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span>? <a name="normalize_selections"><span class="id" title="definition">normalize_selections</span></a> (<span class="id" title="var">type_in_scope</span> : <a class="idref" href="GraphCoQL.Schema.html#Name"><span class="id" title="abbreviation">Name</span></a>) (σ<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> (@<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.Scalar"><span class="id" title="variable">Scalar</span></a>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="abbreviation">seq</span> (@<a class="idref" href="GraphCoQL.Query.html#Selection"><span class="id" title="inductive">Selection</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.Scalar"><span class="id" title="variable">Scalar</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="keyword">wf</span> (<a class="idref" href="GraphCoQL.QueryAux.html#selections_size"><span class="id" title="definition">selections_size</span></a> σ<span class="id" title="var">s</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">_</span> <span class="id" title="notation">[::]</span> := <span class="id" title="notation">[::]</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#ty"><span class="id" title="variable">ty</span></a> (<a class="idref" href="GraphCoQL.QueryNormalForm.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">_</span></a> := <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#98e1012699f08870762b607c45b5fa3b"><span class="id" title="notation">]]</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_fields_with_response_name"><span class="id" title="definition">filter_fields_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#ty"><span class="id" title="variable">ty</span></a> (<a class="idref" href="GraphCoQL.QueryNormalForm.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">_</span></a> := <span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#733561a2d94bd7a99b0d600c93878697"><span class="id" title="notation">]]</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_fields_with_response_name"><span class="id" title="definition">filter_fields_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#ty"><span class="id" title="variable">ty</span></a> (<a class="idref" href="GraphCoQL.QueryNormalForm.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#dc5233cb1d950ecad15b1e9b2514f665"><span class="id" title="variable">β</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#fld"><span class="id" title="variable">fld</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) (<span class="id" title="var">β</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_selection_sets"><span class="id" title="definition">merge_selection_sets</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#find_valid_fields_with_response_name"><span class="id" title="definition">find_valid_fields_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">f</span> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span>)) <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_fields_with_response_name"><span class="id" title="definition">filter_fields_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">{</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#t"><span class="id" title="variable">t</span></a> (<span class="id" title="var">β</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_selection_sets"><span class="id" title="definition">merge_selection_sets</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#find_valid_fields_with_response_name"><span class="id" title="definition">find_valid_fields_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">f</span> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span>)) <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">}</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">t</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.SchemaAux.html#get_possible_types"><span class="id" title="definition">get_possible_types</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)<span class="id" title="notation">]</span> <a class="idref" href="GraphCoQL.Query.html#3888c407a0b5a78bf13c92ec54cfab73"><span class="id" title="notation">}</span></a> <span class="id" title="notation">::</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_fields_with_response_name"><span class="id" title="definition">filter_fields_with_response_name</span></a> <span class="id" title="var">f</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#ty"><span class="id" title="variable">ty</span></a> (<a class="idref" href="GraphCoQL.QueryNormalForm.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#ab410a966ac148e9b78c65c6cdf301fd"><span class="id" title="variable">α</span></a><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#dc5233cb1d950ecad15b1e9b2514f665"><span class="id" title="variable">β</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#lookup_field_in_type"><span class="id" title="definition">lookup_field_in_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#fld"><span class="id" title="variable">fld</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.SchemaAux.html#is_object_type"><span class="id" title="definition">is_object_type</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>) (<span class="id" title="var">β</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_selection_sets"><span class="id" title="definition">merge_selection_sets</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#find_valid_fields_with_response_name"><span class="id" title="definition">find_valid_fields_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">l</span> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span>)) <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_fields_with_response_name"><span class="id" title="definition">filter_fields_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <span class="id" title="var">l</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">:</span></a><span class="id" title="var">f</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">[[</span></a><span class="id" title="var">α</span><a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">]]</span></a> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">{</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">seq</span> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#t"><span class="id" title="variable">t</span></a> (<span class="id" title="var">β</span> <span class="id" title="notation">++</span> <a class="idref" href="GraphCoQL.QueryAux.html#merge_selection_sets"><span class="id" title="definition">merge_selection_sets</span></a> (<a class="idref" href="GraphCoQL.QueryAux.html#find_valid_fields_with_response_name"><span class="id" title="definition">find_valid_fields_with_response_name</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">l</span> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span>)) <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">}</span></a> <span class="id" title="notation">|</span> <span class="id" title="var">t</span> <span class="id" title="notation">&lt;-</span> <a class="idref" href="GraphCoQL.SchemaAux.html#get_possible_types"><span class="id" title="definition">get_possible_types</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">fld</span>.(<a class="idref" href="GraphCoQL.Schema.html#ftype"><span class="id" title="projection">ftype</span></a>)<span class="id" title="notation">]</span> <a class="idref" href="GraphCoQL.Query.html#373f10110922a693810565df5acca770"><span class="id" title="notation">}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<a class="idref" href="GraphCoQL.QueryAux.html#filter_fields_with_response_name"><span class="id" title="definition">filter_fields_with_response_name</span></a> <span class="id" title="var">l</span> σ<span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#ty"><span class="id" title="variable">ty</span></a> (<a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">on</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">{</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#dc5233cb1d950ecad15b1e9b2514f665"><span class="id" title="variable">β</span></a> <a class="idref" href="GraphCoQL.Query.html#ccb33ca3f1a560174215aee39fd888c4"><span class="id" title="notation">}</span></a> <span class="id" title="notation">::</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">σ</span></a><a class="idref" href="GraphCoQL.QueryNormalForm.html#de308430625c7ffbe07e237caf36c338"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <a class="idref" href="GraphCoQL.QueryAux.html#does_fragment_type_apply"><span class="id" title="definition">does_fragment_type_apply</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> := <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> (<span class="id" title="var">β</span> <span class="id" title="notation">++</span> σ<span class="id" title="var">s</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> := <a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <span class="id" title="var">ty</span> σ<span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">do</span> [<span class="id" title="var">leq_selections_size</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

     Normalizes a query, using the <i>Query</i> type to normalize the selection set.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="normalize"><span class="id" title="definition">normalize</span></a> (φ : @<a class="idref" href="GraphCoQL.Query.html#query"><span class="id" title="record">query</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.Scalar"><span class="id" title="variable">Scalar</span></a>) : @<a class="idref" href="GraphCoQL.Query.html#query"><span class="id" title="record">query</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.Scalar"><span class="id" title="variable">Scalar</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>: <a class="idref" href="GraphCoQL.Query.html#Query"><span class="id" title="constructor">Query</span></a> <span class="id" title="var">n</span> <span class="id" title="var">ss</span> := <a class="idref" href="GraphCoQL.QueryNormalForm.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="GraphCoQL.Query.html#Query"><span class="id" title="constructor">Query</span></a> <span class="id" title="var">n</span> (<a class="idref" href="GraphCoQL.QueryNormalForm.html#normalize_selections"><span class="id" title="definition">normalize_selections</span></a> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization.s"><span class="id" title="variable">s</span></a>.(<a class="idref" href="GraphCoQL.Schema.html#query_type"><span class="id" title="projection">query_type</span></a>) <a class="idref" href="GraphCoQL.QueryNormalForm.html#7f48d4a68765673379b41e1b1ee20edf"><span class="id" title="variable">φ</span></a>.(<a class="idref" href="GraphCoQL.Query.html#selection_set"><span class="id" title="projection">selection_set</span></a>)).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="GraphCoQL.QueryNormalForm.html#Normalization"><span class="id" title="section">Normalization</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<hr/>
 
<div class="paragraph"> </div>

    <div>
        <a href='GraphCoQL.QueryConformance.html' class="btn btn-light" role='button'> Previous ← Query Conformance  </a>
        <a href='GraphCoQL.theory.QueryNormalFormLemmas.html' class="btn btn-info" role='button'>Continue Reading → Normal Form Proofs </a>
    </div>

</div>
<div class="code">
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
  </script>

</body>

</html>
